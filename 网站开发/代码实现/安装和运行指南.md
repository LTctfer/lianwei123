# 网站系统安装和运行指南

## 📋 系统要求

### 必需软件
- **Node.js** (版本 18.0.0 或更高)
- **npm** (通常随Node.js一起安装)
- **MySQL** (版本 8.0 或更高)
- **Redis** (版本 6.0 或更高)

### 推荐开发工具
- **Visual Studio Code** (推荐安装以下扩展)
  - TypeScript and JavaScript Language Features
  - ES7+ React/Redux/React-Native snippets
  - Prettier - Code formatter
  - ESLint
  - Auto Rename Tag

## 🚀 快速开始

### 1. 安装Node.js和npm

#### Windows系统
1. 访问 [Node.js官网](https://nodejs.org/)
2. 下载LTS版本（推荐）
3. 运行安装程序，按默认设置安装
4. 打开命令提示符或PowerShell，验证安装：
```bash
node --version
npm --version
```

#### macOS系统
```bash
# 使用Homebrew安装
brew install node

# 或者下载官方安装包
# 访问 https://nodejs.org/ 下载安装
```

#### Linux系统
```bash
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# CentOS/RHEL
curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
sudo yum install -y nodejs
```

### 2. 安装数据库

#### MySQL安装
**Windows:**
1. 下载MySQL Installer from [MySQL官网](https://dev.mysql.com/downloads/installer/)
2. 选择"Developer Default"安装类型
3. 设置root密码（记住这个密码）

**macOS:**
```bash
brew install mysql
brew services start mysql
mysql_secure_installation
```

**Linux:**
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install mysql-server
sudo mysql_secure_installation

# CentOS/RHEL
sudo yum install mysql-server
sudo systemctl start mysqld
sudo mysql_secure_installation
```

#### Redis安装
**Windows:**
1. 下载Redis for Windows from [GitHub](https://github.com/microsoftarchive/redis/releases)
2. 解压并运行redis-server.exe

**macOS:**
```bash
brew install redis
brew services start redis
```

**Linux:**
```bash
# Ubuntu/Debian
sudo apt install redis-server
sudo systemctl start redis-server

# CentOS/RHEL
sudo yum install redis
sudo systemctl start redis
```

### 3. 项目安装

#### 克隆或下载项目
```bash
# 如果使用Git
git clone <项目地址>
cd 网站开发/代码实现

# 或者直接下载项目文件到本地
```

#### 安装后端依赖
```bash
cd server
npm install
```

#### 安装前端依赖
```bash
cd ../client
npm install
```

### 4. 环境配置

#### 后端环境配置
1. 复制环境变量模板：
```bash
cd server
cp .env.example .env
```

2. 编辑 `.env` 文件，配置以下参数：
```env
# 数据库配置
DATABASE_URL="mysql://username:password@localhost:3306/website_system"

# JWT密钥（请使用强密码）
JWT_SECRET="your-super-secret-jwt-key-change-this-in-production"
JWT_EXPIRES_IN="1h"

# Redis配置
REDIS_URL="redis://localhost:6379"

# 邮件服务配置
SMTP_HOST="smtp.gmail.com"
SMTP_PORT="587"
SMTP_USER="your-email@gmail.com"
SMTP_PASS="your-app-password"

# 应用配置
APP_NAME="网站系统"
FRONTEND_URL="http://localhost:3000"
PORT="3001"

# 加密配置
BCRYPT_ROUNDS="12"
```

#### 数据库初始化
```bash
# 生成Prisma客户端
npx prisma generate

# 创建数据库表
npx prisma db push

# （可选）填充示例数据
npm run seed
```

### 5. 启动应用

#### 启动后端服务器
```bash
cd server
npm run dev
```
后端服务器将在 http://localhost:3001 启动

#### 启动前端应用
```bash
# 新开一个终端窗口
cd client
npm start
```
前端应用将在 http://localhost:3000 启动

## 🔧 开发工具配置

### VS Code配置
创建 `.vscode/settings.json` 文件：
```json
{
  "typescript.preferences.importModuleSpecifier": "relative",
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  }
}
```

### Prettier配置
创建 `.prettierrc` 文件：
```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 80,
  "tabWidth": 2
}
```

## 📊 功能测试

### 1. 测试用户注册和登录
1. 访问 http://localhost:3000
2. 点击"注册"按钮
3. 填写注册信息
4. 检查邮箱验证邮件
5. 使用注册的账号登录

### 2. 测试API接口
```bash
# 测试健康检查
curl http://localhost:3001/api/health

# 测试用户注册
curl -X POST http://localhost:3001/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "password123",
    "confirmPassword": "password123"
  }'
```

## 🚨 常见问题解决

### 1. 端口占用问题
```bash
# 查看端口占用
netstat -ano | findstr :3000
netstat -ano | findstr :3001

# 杀死占用端口的进程
taskkill /PID <进程ID> /F
```

### 2. 数据库连接问题
- 确保MySQL服务正在运行
- 检查数据库用户名和密码
- 确认数据库已创建

### 3. Redis连接问题
- 确保Redis服务正在运行
- 检查Redis配置和端口

### 4. 邮件服务问题
- 如使用Gmail，需要开启"应用专用密码"
- 检查SMTP配置是否正确

## 📦 生产部署

### 1. 构建前端应用
```bash
cd client
npm run build
```

### 2. 构建后端应用
```bash
cd server
npm run build
```

### 3. 使用PM2部署
```bash
# 安装PM2
npm install -g pm2

# 启动应用
pm2 start dist/app.js --name "website-system-server"
pm2 startup
pm2 save
```

### 4. 使用Nginx反向代理
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        root /path/to/client/build;
        try_files $uri $uri/ /index.html;
    }

    location /api {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

## 📞 技术支持

如果在安装或运行过程中遇到问题，请：

1. 检查系统要求是否满足
2. 查看错误日志信息
3. 参考常见问题解决方案
4. 联系技术支持团队

## 🎯 下一步

安装完成后，您可以：

1. 浏览系统各个功能模块
2. 查看管理后台
3. 测试电商功能
4. 体验用户社区
5. 查看数据分析报表

祝您使用愉快！🎉